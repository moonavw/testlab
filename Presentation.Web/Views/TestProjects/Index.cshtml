@model IEnumerable<TestLab.Domain.TestProject>

@{
    ViewBag.Title = "TestProjects";
}

<h2>TestProjects</h2>

<p>
    @Html.ActionLink("Create New", "New", null, new { @class = "btn btn-default" })
</p>

@Html.Grid(Model).Columns(c =>
{
    c.Add()
     .Encoded(false)
     .Sanitized(false)
     .SetWidth(30)
     .RenderValueAs(d =>
                        Html.ActionLink("Open", "Show", new {id = d.Id}, new {@class = "btn btn-default"})
        );

    c.Add(o => o.Id);
    
    c.Add(o => o.Name);

    c.Add(o => o.DriverName);

    c.Add(o => o.Build.Started)
     .SetWidth(110)
     .Encoded(false)
     .Sanitized(false)
     .RenderValueAs(d =>
                        @<div>
                             @if (d.Build.Started == null)
                             {
                                 @Html.ActionLink("Build", "Build", "TestProjects", new {id = d.Id}, new {@class = "btn btn-success ajax-post"})
                             }
                             else
                             {
                                 @d.Build.Started
                             }
                         </div>
        );

    c.Add(o => o.Build.Completed)
     .SetWidth(110);
    
    c.Add(o => o.Plans.Count);

    c.Add(o => o.Cases.Count);

}).Sortable().Filterable().WithMultipleFilters().WithPaging(20)

@section scripts{
    @Scripts.Render("~/bundles/gridmvc")
}