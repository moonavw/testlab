@model IEnumerable<TestSession>

@{
    ViewBag.Title = "Test Sessions";
    TestProject project = ViewBag.Project;
}

<h2>Test Sessions</h2>
<p>
    @Html.ActionLink("Create New", "New", "TestSessions", new { testprojectId = project.Id }, new { @class = "btn btn-default" })
</p>

@Html.Grid(Model.OrderByDescending(z=>z.Id)).Columns(c =>
{
    c.Add()
     .Encoded(false)
     .Sanitized(false)
     .SetWidth(30)
     .RenderValueAs(d =>
                        Html.ActionLink("Open", "Show", "TestSessions", new { id = d.Id, testprojectId = project.Id }, new { @class = "btn btn-default" })
        );

    c.Add(o => o.Id)
     .SortInitialDirection(GridMvc.Sorting.GridSortDirection.Descending);
    
    c.Add(o => o.Name);

    c.Add()
     .Titled("Agents")
     .RenderValueAs(d => string.Join(",", d.Queues.Select(z => z.Agent.Name)));
    
    c.Add(o => o.Build);
   
    c.Add(o => o.Started)
     .SetWidth(110);

    c.Add(o => o.Completed)
     .SetWidth(110);

    c.Add()
     .Encoded(false)
     .Sanitized(false)
     .Titled("Progress")
     .SetWidth(200)
     .RenderValueAs(d => Html.Partial("_ShowProgress", d));

}).Sortable().Filterable().WithMultipleFilters().WithPaging(20)
